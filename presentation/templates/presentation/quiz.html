{% extends 'presentation/base.html' %}

{% block content %}
<style>
    /* Styles spécifiques au Quiz TAROT */
    .quiz-title {
        font-size: 3rem;
        background: linear-gradient(135deg, #3b82f6, #06b6d4);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
        margin-bottom: 1rem;
        font-weight: 700;
    }

    .quiz-subtitle {
        text-align: center;
        color: #94a3b8;
        font-size: 1.1rem;
        margin-bottom: 3rem;
    }

    .quiz-container {
        max-width: 800px;
        margin: 0 auto;
    }

    /* Écran de démarrage */
    .start-screen {
        text-align: center;
        padding: 3rem 2rem;
        background: rgba(51, 65, 85, 0.6);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(100, 116, 139, 0.2);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .start-screen h3 {
        font-size: 1.8rem;
        color: #e2e8f0;
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .start-screen p {
        color: #cbd5e1;
        font-size: 1.1rem;
        margin-bottom: 2rem;
    }

    /* Bouton de jeu */
    .btn-play {
        background: linear-gradient(135deg, #3b82f6, #06b6d4);
        color: white;
        padding: 1rem 2.5rem;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        font-family: 'Inter', sans-serif;
    }

    .btn-play:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
    }

    .btn-play:active {
        transform: translateY(0);
    }

    /* Barre de progression */
    .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(51, 65, 85, 0.8);
        border-radius: 10px;
        margin-bottom: 2rem;
        overflow: hidden;
        border: 1px solid rgba(100, 116, 139, 0.2);
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #3b82f6, #06b6d4, #10b981);
        border-radius: 10px;
        transition: width 0.5s ease;
        box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
    }

    /* Carte de question */
    .question-card {
        background: rgba(51, 65, 85, 0.6);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(100, 116, 139, 0.2);
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .question-number {
        color: #06b6d4;
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 1rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .question-text {
        font-size: 1.4rem;
        color: #f1f5f9;
        margin-bottom: 2rem;
        font-weight: 500;
        line-height: 1.5;
    }

    /* Options de réponse */
    .options {
        display: grid;
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .option {
        background: rgba(30, 41, 59, 0.8);
        border: 2px solid rgba(100, 116, 139, 0.3);
        border-radius: 12px;
        padding: 1.2rem 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        color: #cbd5e1;
        font-weight: 500;
        position: relative;
        overflow: hidden;
    }

    .option:hover {
        border-color: rgba(59, 130, 246, 0.5);
        background: rgba(59, 130, 246, 0.1);
        transform: translateX(5px);
    }

    .option.selected {
        border-color: #3b82f6;
        background: rgba(59, 130, 246, 0.2);
        color: #ffffff;
    }

    .option.correct {
        border-color: #10b981;
        background: rgba(16, 185, 129, 0.2);
        color: #ffffff;
        animation: correctPulse 0.6s ease;
    }

    .option.incorrect {
        border-color: #ef4444;
        background: rgba(239, 68, 68, 0.2);
        color: #ffffff;
        animation: incorrectShake 0.6s ease;
    }

    @keyframes correctPulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.02); }
    }

    @keyframes incorrectShake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
    }

    /* Bouton caché */
    .hidden {
        opacity: 0;
        pointer-events: none;
        transform: translateY(10px);
    }

    /* Écran de résultats */
    .results-screen {
        text-align: center;
        padding: 3rem 2rem;
        background: rgba(51, 65, 85, 0.6);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(100, 116, 139, 0.2);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .results-screen h2 {
        font-size: 2.5rem;
        color: #f1f5f9;
        margin-bottom: 1.5rem;
        font-weight: 700;
    }

    .score-value {
        font-size: 4rem;
        font-weight: 800;
        background: linear-gradient(135deg, #3b82f6, #06b6d4, #10b981);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 1.5rem;
    }

    /* Étoiles */
    .stars {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
    }

    .star {
        font-size: 2rem;
        animation: starPop 0.6s ease;
    }

    @keyframes starPop {
        0% {
            transform: scale(0);
            opacity: 0;
        }
        50% {
            transform: scale(1.2);
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    /* Badges */
    .badge {
        display: inline-block;
        padding: 1rem 2rem;
        border-radius: 15px;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        animation: badgeGlow 2s ease infinite;
    }

    .badge.expert {
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        color: #1f2937;
        box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
    }

    .badge.advanced {
        background: linear-gradient(135deg, #94a3b8, #64748b);
        color: #ffffff;
        box-shadow: 0 0 20px rgba(148, 163, 184, 0.4);
    }

    .badge.intermediate {
        background: linear-gradient(135deg, #cd7c0f, #92400e);
        color: #ffffff;
        box-shadow: 0 0 20px rgba(205, 124, 15, 0.4);
    }

    .badge.beginner {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: #ffffff;
        box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
    }

    @keyframes badgeGlow {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    /* Message de score */
    #scoreMessage p {
        color: #cbd5e1;
        font-size: 1.1rem;
        margin-bottom: 2rem;
        line-height: 1.6;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .quiz-title {
            font-size: 2.5rem;
        }

        .question-card {
            padding: 2rem;
        }

        .question-text {
            font-size: 1.2rem;
        }

        .option {
            padding: 1rem;
        }

        .score-value {
            font-size: 3rem;
        }

        .results-screen h2 {
            font-size: 2rem;
        }

        .start-screen {
            padding: 2rem 1.5rem;
        }

        .start-screen h3 {
            font-size: 1.5rem;
        }
    }
</style>

<h1 class="quiz-title">Quiz Spatial TAROT</h1>
<p class="quiz-subtitle">Testez vos connaissances sur l'astronomie et le réseau TAROT !</p>

<div class="quiz-container">
    
    <!-- Écran de démarrage du quiz -->
    <div id="quizStartScreen" class="start-screen">
        <h3>Explorez vos connaissances sur les télescopes robotiques</h3>
        <p>10 questions pour devenir un expert des télescopes TAROT</p>
        <button class="btn-play" onclick="startQuiz()" style="margin-top: 2rem;">Commencer le Quiz</button>
    </div>
    
    <!-- Zone de quiz -->
    <div id="quizArea" style="display: none;">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div id="questionCard" class="question-card">
            <div class="question-number" id="questionNumber">Question 1/10</div>
            <div class="question-text" id="questionText"></div>
            <div class="options" id="optionsContainer"></div>
            <button class="btn-play hidden" id="nextBtn" onclick="nextQuestion()" style="margin-top: 2rem;">Question suivante</button>
        </div>
    </div>
    
    <!-- Écran de résultats -->
    <div id="quizResultsScreen" class="results-screen" style="display: none;">
        <h2>Résultats du Quiz</h2>
        <div class="score-value" id="finalScore">0/10</div>
        <div class="stars" id="starsDisplay"></div>
        <div id="badgeDisplay"></div>
        <div id="scoreMessage"></div>
        <button class="btn-play" onclick="restartQuiz()" style="margin-top: 2rem;">Recommencer</button>
    </div>
    
</div>

<script>
    // QUIZ
    const questions = [
        {
            question: "Que signifie l'acronyme TAROT ?",
            options: [
                "Télescopes à Action Rapide pour les Objets Transitoires",
                "Télescopes Automatiques de Recherche d'Objets Temporaires",
                "Système de Télescopes Automatisés pour la Recherche",
                "Télescopes d'Analyse Rapide d'Objets Temporaires"
            ],
            correct: 0
        },
        {
            question: "Combien de télescopes composent le réseau TAROT ?",
            options: ["2", "3", "4", "5"],
            correct: 2
        },
        {
            question: "Où se trouve le télescope TAROT en France ?",
            options: ["Pic du Midi", "Calern", "Haute-Provence", "Marseille"],
            correct: 1
        },
        {
            question: "Quel est le nom du logiciel qui pilote les télescopes TAROT ?",
            options: ["TAROT-OS", "PyROS", "RoboScope", "AutoTel"],
            correct: 1
        },
        {
            question: "Quelle est l'altitude du site TAROT au Chili ?",
            options: ["1270m", "2400m", "1000m", "400m"],
            correct: 1
        },
        {
            question: "Le projet EU-SST concerne :",
            options: [
                "L'étude des exoplanètes",
                "La surveillance de l'espace",
                "Les ondes gravitationnelles",
                "La météorologie spatiale"
            ],
            correct: 1
        },
        {
            question: "Qu'est-ce qu'un sursaut gamma (GRB) ?",
            options: [
                "Une aurore boréale",
                "L'explosion d'une étoile massive",
                "Une éruption solaire",
                "La collision de deux galaxies"
            ],
            correct: 1
        },
        {
            question: "Le framework utilisé pour PyROS est :",
            options: ["Flask", "Django", "FastAPI", "Tornado"],
            correct: 1
        },
        {
            question: "Quel organisme français gère le réseau TAROT avec l'IRAP ?",
            options: ["ESA", "CNRS", "CNES", "CEA"],
            correct: 2
        },
        {
            question: "Les télescopes TAROT observent principalement :",
            options: [
                "Les planètes du système solaire",
                "Les objets transitoires et les satellites",
                "Les comètes uniquement",
                "La surface lunaire"
            ],
            correct: 1
        }
    ];

    let currentQuestion = 0;
    let quizScore = 0;
    let selectedAnswer = null;

    function startQuiz() {
        document.getElementById('quizStartScreen').style.display = 'none';
        document.getElementById('quizArea').style.display = 'block';
        currentQuestion = 0;
        quizScore = 0;
        showQuestion();
    }

    function showQuestion() {
        const question = questions[currentQuestion];
        
        document.getElementById('questionNumber').textContent = `Question ${currentQuestion + 1}/10`;
        document.getElementById('questionText').textContent = question.question;
        
        const optionsContainer = document.getElementById('optionsContainer');
        optionsContainer.innerHTML = '';
        
        question.options.forEach((option, index) => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option';
            optionDiv.textContent = option;
            optionDiv.onclick = () => selectQuizOption(index, optionDiv);
            optionsContainer.appendChild(optionDiv);
        });
        
        document.getElementById('nextBtn').classList.add('hidden');
        selectedAnswer = null;
        
        const progress = ((currentQuestion) / questions.length) * 100;
        document.getElementById('progressFill').style.width = progress + '%';
        
        document.getElementById('questionCard').style.animation = 'none';
        setTimeout(() => {
            document.getElementById('questionCard').style.animation = 'slideIn 0.5s ease';
        }, 10);
    }

    function selectQuizOption(index, element) {
        if (selectedAnswer !== null) return;
        
        document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
        element.classList.add('selected');
        
        selectedAnswer = index;
        const question = questions[currentQuestion];
        
        setTimeout(() => {
            document.querySelectorAll('.option').forEach((opt, i) => {
                if (i === question.correct) {
                    opt.classList.add('correct');
                } else if (i === selectedAnswer && i !== question.correct) {
                    opt.classList.add('incorrect');
                }
            });
            
            if (selectedAnswer === question.correct) {
                quizScore++;
                createParticles(element);
            }
            
            document.getElementById('nextBtn').classList.remove('hidden');
        }, 500);
    }

    function createParticles(element) {
        for (let i = 0; i < 10; i++) {
            const particle = document.createElement('div');
            particle.style.cssText = `
                position: fixed;
                width: 8px;
                height: 8px;
                background: #10b981;
                border-radius: 50%;
                pointer-events: none;
                z-index: 1000;
                animation: particle 1s ease-out forwards;
            `;
            
            const rect = element.getBoundingClientRect();
            particle.style.left = (rect.left + rect.width / 2) + 'px';
            particle.style.top = (rect.top + rect.height / 2) + 'px';
            
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }
        
        if (!document.getElementById('particle-style')) {
            const style = document.createElement('style');
            style.id = 'particle-style';
            style.textContent = `
                @keyframes particle {
                    0% { 
                        transform: scale(0) translate(0, 0); 
                        opacity: 1; 
                    }
                    100% { 
                        transform: scale(1) translate(${(Math.random() - 0.5) * 200}px, ${(Math.random() - 0.5) * 200}px); 
                        opacity: 0; 
                    }
                }
            `;
            document.head.appendChild(style);
        }
    }

    function nextQuestion() {
        currentQuestion++;
        
        if (currentQuestion < questions.length) {
            showQuestion();
        } else {
            showQuizResults();
        }
    }

    function showQuizResults() {
        document.getElementById('quizArea').style.display = 'none';
        document.getElementById('quizResultsScreen').style.display = 'block';
        
        document.getElementById('finalScore').textContent = `${quizScore}/10`;
        
        const starsContainer = document.getElementById('starsDisplay');
        const starCount = Math.ceil((quizScore / 10) * 5);
        starsContainer.innerHTML = '';
        
        for (let i = 0; i < 5; i++) {
            const star = document.createElement('span');
            star.className = 'star';
            star.textContent = i < starCount ? '⭐' : '☆';
            star.style.animationDelay = (i * 0.2) + 's';
            starsContainer.appendChild(star);
        }
        
        const badgeContainer = document.getElementById('badgeDisplay');
        const messageContainer = document.getElementById('scoreMessage');
        
        if (quizScore >= 9) {
            badgeContainer.innerHTML = '<div class="badge expert">🏆 Expert Spatial</div>';
            messageContainer.innerHTML = '<p>Impressionnant ! Vous maîtrisez parfaitement le réseau TAROT et l\'astronomie !</p>';
        } else if (quizScore >= 7) {
            badgeContainer.innerHTML = '<div class="badge advanced">🥈 Astronome Avancé</div>';
            messageContainer.innerHTML = '<p>Très bien ! Vous avez d\'excellentes connaissances spatiales.</p>';
        } else if (quizScore >= 5) {
            badgeContainer.innerHTML = '<div class="badge intermediate">🥉 Observateur Intermédiaire</div>';
            messageContainer.innerHTML = '<p>Pas mal ! Continuez à explorer l\'univers TAROT.</p>';
        } else {
            badgeContainer.innerHTML = '<div class="badge beginner">🌟 Débutant Curieux</div>';
            messageContainer.innerHTML = '<p>Un bon début ! Explorez davantage le site pour en apprendre plus.</p>';
        }
    }

    function restartQuiz() {
        document.getElementById('quizResultsScreen').style.display = 'none';
        document.getElementById('quizStartScreen').style.display = 'block';
        currentQuestion = 0;
        quizScore = 0;
        selectedAnswer = null;
    }
</script>

{% endblock %}